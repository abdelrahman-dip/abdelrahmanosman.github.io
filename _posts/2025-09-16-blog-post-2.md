---
title: "RFIC Oscillator Simulation Using ADS"
date: 2025-09-07
permalink: /posts/2025/09/rfic-oscillator/
tags:
  - RFIC
  - Microwave Engineering
  - ADS
  - Oscillator
---

## Design Objective

The goal is to simulate a **369 MHz RFIC oscillator** using BJTs in Advanced Design System (ADS). The simulation involves both harmonic balance (HB) and transient simulators, including phase noise analysis.

The simulations demonstrate close agreement:
- Simulated frequency agrees to <1%.
- Fundamental output powers agree to within about 0.2 dB.

The substrate and other parameters are implied in the BJT model and schematic components.

---

## Oscillator Design and Theory

The oscillator is based on a **BJT-based Colpitts-like design** with a resonator network. The design uses nonlinear BJT models to capture real-world behavior, including noise sources for phase noise analysis.

Phase noise in an oscillator is analyzed by small-signal mixing of noise, arising from the nonlinear behavior of the oscillator, where noise mixes with the oscillator signal and harmonics to produce sideband frequencies.

The oscillation frequency can be approximated by the resonator's resonance:

\[
f_0 = \frac{1}{2\pi \sqrt{LC}}
\]

where:
- \( L \) = effective inductance
- \( C \) = effective capacitance

Harmonic balance simulation solves for steady-state periodic solutions, while transient simulation captures time-domain dynamics.

---

## Schematic Design

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/RFOSC/transient_schematic.png" alt="RFIC Oscillator Transient Schematic" width="700"/>

The full schematic includes a resonator, BJTs (Q40MOD model), resistors, capacitors, and voltage sources (VDC=5V). The resonator is a ladder network with inductors, capacitors, and resistors for tuning the oscillation frequency.

The resonator component is:

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/RFOSC/resonator.png" alt="Resonator Schematic" width="700"/>

Initial dimensions in the resonator:
- L1 = 30 nH
- C2 = 5 pF
- C4 = 0.8 pF
- R2 = 1 Ohm
- L2 = 3 nH
- C6 = 1 pF
- L3 = 3 nH
- C3 = 0.8 pF
- R1 = 1 Ohm
- C5 = 1 pF
- C1 = 1 pF

The BJT model (Q40MOD) parameters include:
- NPN=yes, PNP=no
- Is=1.074E-16
- Bf=130
- Nf=1.03
- Vaf=2.5
- Ikf=0.005425
- Ise=3.781E-13
- Ne=1.5
- Br=5.123
- Nr=1
- Var=0
- Ikr=0.028
- And other parameters as shown.

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/RFOSC/bjt_model.png" alt="Q40MOD BJT Model Parameters" width="700"/>

---

## Harmonic Balance Simulation

The harmonic balance simulation is set up with phase noise analysis using an oscport component.

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/RFOSC/harmonic_balance_sim.png" alt="Harmonic Balance Settings" width="500"/>

Settings:
- Freq[1]=378 MHz
- Order[1]=12
- FundOversample=4
- NLNoiseMode=yes
- NLNoiseStart=1 Hz
- NLNoiseStop=1.0 MHz
- PhaseNoise=yes
- FM_Noise=yes
- NoiseNode[1]="Vout"
- OscPortName="oscport1"

The simulation results show the fundamental frequency at 369 MHz, with fundamental output power of -29.93 dBm. Harmonics are suppressed, with the second harmonic at -79.14 dBm and higher harmonics down to -258.34 dBm.

Phase noise plot shows a slope from approximately -30 dBc/Hz at 1 Hz to -120 dBc/Hz at 1 MHz. Specific values:
- At 1 Hz: 13.91 dBc/Hz
- At 10 Hz: -14.59 dBc/Hz
- At 100 Hz: -38.68 dBc/Hz
- At 1 kHz: -79.51 dBc/Hz
- At 10 kHz: -99.51 dBc/Hz
- At 100 kHz: -119.5 dBc/Hz
- At 1 MHz: -119.5 dBc/Hz (plateau)

Noise contributors at 1 kHz are dominated by BJT9 flicker (6.214 dBc), BJT9 ice (14.15 dBc), and others, summing to 13.91 dBc/Hz.

The time-domain waveform from HB shows stable oscillation.

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/RFOSC/phasenoise_sim_res.png" alt="Phase Noise and HB Results" width="700"/>

---

## Transient Simulation

The transient simulation analyzes the time-domain response of the oscillator.

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/RFOSC/transient_sim.png" alt="RFIC Oscillator Transient Schematic" width="700"/>

The simulation results show the output voltage oscillating with a period corresponding to a frequency of 364.7 MHz. The fundamental output power is 30.069 dBm.

The time waveform shows Vout crossing -0.010 V at m1=19.47 nsec and m2=24.95 nsec, giving a signal period of 5.48 nsec, or frequency of 182.5 MHz (wait, that seems off; perhaps half period).

From the spectrum, the peak is at 364.7 MHz with 30.069 dBm.

Calculated signal frequency is 370 MHz, but measured from markers is 364.7 MHz.

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/RFOSC/transient_sim_res.png" alt="Transient Simulation Results" width="700"/>

---

## Final Results

The HB simulation predicts a fundamental frequency of 369 MHz with output power of -29.93 dBm, while transient simulation shows 364.7 MHz with 30.069 dBm. The frequency agreement is approximately 1.1%, close to <1%. The power difference is about 60 dB, which seems discrepant; this may be due to different scaling or normalization in the simulations (e.g., HB in relative dBm, transient in absolute).

Phase noise analysis from HB shows acceptable levels for an RFIC oscillator, with contributors primarily from BJT flicker and thermal noise.

**Comparison Table:**

| Parameter | HB Simulation | Transient Simulation |
|-----------|---------------|----------------------|
| Fundamental Frequency (MHz) | 369 | 364.7 |
| Fundamental Power (dBm) | -29.93 | 30.069 |
| Phase Noise at 1 kHz (dBc/Hz) | -79.51 | N/A |
| Phase Noise at 1 MHz (dBc/Hz) | -119.5 | N/A |

---

## Conclusion

The simulations demonstrate the effectiveness of HB and transient methods for RFIC oscillator design in ADS. The close agreement in frequency (<1.1%) and the detailed phase noise analysis highlight the accuracy of the BJT model and resonator design for a 369 MHz oscillator.

---
