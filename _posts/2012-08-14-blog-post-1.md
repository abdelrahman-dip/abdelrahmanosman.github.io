---
title: "Short Note — Reconstruction Loss & PSD Regularization"
date: 2025-09-06
permalink: /posts/2025/09/short-loss-note/
tags:
  - radar
  - transformer
  - signal-processing
---

A very short note on loss choices for signal-reconstruction models (e.g., transformer autoencoders for MIMO radar). Two compact, complementary objectives that I often use are the time-domain MSE and a frequency-domain (PSD) consistency term.

**Mean squared error (MSE)** — measures sample-wise reconstruction fidelity:
$$
\mathcal{L}_{\mathrm{MSE}} = \frac{1}{N}\sum_{n=1}^{N}\|x_n - \hat{x}_n\|_2^2,
$$
where \(x_n\) and \(\hat{x}_n\) are the target and reconstructed complex-IQ vectors (treated as real pairs).

**PSD consistency loss** — encourages the model to match spectral magnitude:
$$
\mathcal{L}_{\mathrm{PSD}} = \frac{1}{K}\sum_{k=1}^{K}\big( |\mathrm{FFT}(x_n)[k]| - |\mathrm{FFT}(\hat{x}_n)[k]|\big)^2.
$$

Combine them with a weighting factor \(\lambda\):
$$
\mathcal{L} = \mathcal{L}_{\mathrm{MSE}} + \lambda\,\mathcal{L}_{\mathrm{PSD}}.
$$

```plotly
{
  "data": [
    {
      "x": [0.0,0.1570796327,0.3141592654,0.4712388980,0.6283185307,0.7853981634,0.9424777961,1.0995574288,1.2566370614,1.4137166941,1.5707963268,1.7278759595,1.8849555922,2.0420352249,2.1991148575,2.3561944902,2.5132741229,2.6703537556,2.8274333882,2.9845130209,3.1415926536,3.2986722863,3.4557519190,3.6128315516,3.7699111843,3.9269908170,4.0840704497,4.2411500824,4.3982297150,4.5553093477,4.7123889804,4.8694686131,5.0265482457,5.1836278784,5.3407075111,5.4977871438,5.6548667765,5.8119464091,5.9690260418,6.1261056745,6.2831853072],
      "y": [0.0,0.1564344650,0.3090169899,0.4546487134,0.5877852523,0.7071067812,0.8090169944,0.8910065242,0.9510565163,0.9876883406,1.0,0.9876883406,0.9510565163,0.8910065242,0.8090169944,0.7071067812,0.5877852523,0.4546487134,0.3090169899,0.1564344650,0.0,-0.1564344650,-0.3090169899,-0.4546487134,-0.5877852523,-0.7071067812,-0.8090169944,-0.8910065242,-0.9510565163,-0.9876883406,-1.0,-0.9876883406,-0.9510565163,-0.8910065242,-0.8090169944,-0.7071067812,-0.5877852523,-0.4546487134,-0.3090169899,-0.1564344650,0.0],
      "type": "scatter",
      "mode": "lines",
      "name": "y = sin(x)"
    }
  ],
  "layout": {
    "title": "y = sin(x) on [0, 2\\u03c0]",
    "xaxis": {"title": "x"},
    "yaxis": {"title": "y"}
  }
}

```

*Implementation note:* normalize per-channel (zero mean, unit variance) before computing losses and tune \(\lambda\) so PSD and MSE magnitudes are comparable. This small hybrid loss often preserves both time-domain waveform fidelity and spectral shape — useful when downstream radar/communication metrics (EVM, detection) are sensitive to spectral distortions.
