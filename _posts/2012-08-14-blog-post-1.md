---
title: "Low Noise Amplifier (LNA) Design Using ADS"
date: 2025-09-06
permalink: /posts/2025/09/bandpass-filter/
tags:
  - RFIC
  - Microwave Engineering
  - ADS
  - Low Noise Amplifier
---

## Introduction

The goal is to design a **Low Noise Amplifier (LNA)** operating from \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), using Advanced Design System (ADS). The design specifications are as follows:

- **Frequency range**: \\( \\SI{1.4}{\\giga\\hertz} \\)–\\( \\SI{1.8}{\\giga\\hertz} \\)
- **Gain**: \\( \\geq \\SI{12}{\\deci\\bel} \\)
- **Input/output return loss**: \\( \\geq \\SI{10}{\\deci\\bel} \\) (i.e., \\( S\_{11} \\) and \\( S\_{22} \\leq \\SI{-10}{\\deci\\bel} \\))
- **Noise figure**: \\( \\leq \\SI{2}{\\deci\\bel} \\)
- **Stability factor**: \\( K &gt; 1 \\) across the band (unconditional stability)

The design process involved schematic creation, component selection, initial simulation, optimization, and final performance evaluation. The LNA was designed using microstrip technology with a single-stage topology, focusing on achieving a balance between low noise figure, high gain, and stability. This post details each step, including challenges faced (e.g., initial poor output matching and high noise figure) and the optimization strategies employed to meet the specifications.

---

## Schematic Design

The LNA was designed as a single-stage amplifier using microstrip lines for matching and biasing networks. The complete schematic features the following components:

- **Input Matching Network**: Composed of microstrip lines (TL4, TL5) and a DC block capacitor (C1) to ensure proper impedance matching at the input while blocking DC signals. The matching network was designed to minimize the noise figure by aligning the input impedance close to the optimum noise match (\\( \\Gamma\_{\\text{opt}} \\)).
- **Bias Network**: Includes a microstrip line (TL6) and an RF choke (MLEF) to provide the DC bias to the transistor while isolating the RF signal path. The bias network ensures the transistor operates at the desired operating point for low noise and high gain.
- **Output Matching Network**: Composed of microstrip lines (TL2, TL3) and a DC block capacitor (C2) to match the output impedance to \\( \\SI{50}{\\ohm} \\), ensuring maximum power transfer and good return loss.
- **Stabilization Components**: The design initially lacked explicit stabilization components (e.g., series resistors), but stability was addressed through optimization of the matching networks to achieve a stability factor \\( K &gt; 1 \\).

The schematic uses the ATF-54111 transistor, a GaAs pHEMT, selected for its low noise figure and high gain characteristics. The input and output ports are terminated with \\( \\SI{50}{\\ohm} \\) loads (Term1 and Term2), and the substrate is defined as "MSub1" with a thickness of \\( \\SI{0.5}{\\milli\\meter} \\).

![LNA schematic](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/lna_schem.png)\---

## Component Selection

The transistor chosen for the LNA is the hp-AT-41511-2-19950125, a GaAs pHEMT, selected for the following reasons:

- **Low Noise Figure**: The ATF-54111 has a minimum noise figure (\\( F\_{\\text{min}} \\)) of approximately \\( \\SI{0.5}{\\deci\\bel} \\) to \\( \\SI{1.0}{\\deci\\bel} \\) at \\( \\SI{1.6}{\\giga\\hertz} \\), making it suitable for low-noise applications. The noise figure of the LNA is given by the Friis formula for a single-stage amplifier:

$$ F = F\_{\\text{min}} + \\frac{R_n}{G_s} |\\Gamma_s - \\Gamma\_{\\text{opt}}|^2 $$

where:

- \\( F\_{\\text{min}} \\) = minimum noise figure
- \\( R_n \\) = equivalent noise resistance
- \\( G_s \\) = source conductance
- \\( \\Gamma_s \\) = source reflection coefficient
- \\( \\Gamma\_{\\text{opt}} \\) = optimum source reflection coefficient for minimum noise

The low \\( F\_{\\text{min}} \\) of the ATF-54111 ensures a good starting point for achieving the \\( \\SI{2}{\\deci\\bel} \\) noise figure goal.

- **Adequate Gain**: The transistor provides a maximum available gain (\\( G\_{\\text{max}} \\)) greater than \\( \\SI{15}{\\deci\\bel} \\) at \\( \\SI{1.6}{\\giga\\hertz} \\), which supports the design goal of \\( \\geq \\SI{12}{\\deci\\bel} \\). The gain of a single-stage amplifier can be approximated as:

$$ G = |S\_{21}|^2 \\frac{(1 - |\\Gamma_s|^2)(1 - |\\Gamma_L|^2)}{|1 - S\_{11}\\Gamma_s|^2 |1 - S\_{22}\\Gamma_L|^2} $$

where:

- \\( \\Gamma_s \\) = source reflection coefficient
- \\( \\Gamma_L \\) = load reflection coefficient

The high \\( G\_{\\text{max}} \\) ensures the gain requirement can be met with proper matching.

- **Good Input/Output Match Capability**: The ATF-54111 has S-parameters that allow for effective impedance matching using microstrip lines, as evidenced by the final S11 and S22 values achieved after optimization.

Other components, such as the DC block capacitors (C1, C2) and microstrip lines, were chosen to operate effectively at the target frequency range, with values optimized during the design process.

---

## Substrate Parameters

The microstrip design uses a substrate with the following parameters, which are typical for FR-4 but adjusted based on the schematic’s "MSub1" definition:

- \\( \\epsilon_r = 4.3 \\) (relative permittivity)
- \\( h = \\SI{0.5}{\\milli\\meter} \\) (substrate thickness)
- \\( \\tan\\delta = 0.02 \\) (loss tangent)
- \\( t = \\SI{35}{\\micro\\meter} \\) (copper thickness)

The characteristic impedance (\\( Z_0 \\)) of the microstrip lines was calculated using the approximate formula for a microstrip line:

$$ Z_0 = \\frac{87}{\\sqrt{\\epsilon_r + 1.41}} \\ln\\left(\\frac{5.98h}{0.8w + t}\\right) $$

where:

- \\( w \\) = width of the microstrip line

During optimization, the widths (w11 to w23) were tuned to achieve the desired impedance matching. For example, with \\( h = \\SI{0.5}{\\milli\\meter} \\), \\( \\epsilon_r = 4.3 \\), and \\( t = \\SI{35}{\\micro\\meter} \\), a width \\( w \\approx \\SI{1}{\\milli\\meter} \\) (typical for the optimized values like w11 = \\( \\SI{2.8233}{\\milli\\meter} \\)) yields a \\( Z_0 \\) close to \\( \\SI{50}{\\ohm} \\), which is ideal for matching to the \\( \\SI{50}{\\ohm} \\) terminations. The loss tangent (\\( \\tan\\delta = 0.02 \\)) indicates moderate substrate losses, which contribute to the overall noise figure and gain flatness.

---

## Initial Simulation Results

The initial performance of the LNA, before any optimization, is shown below. The plots include S21 (gain), S11 (input return loss), S22 (output return loss), and SP_STBFACT (stability factor) over a frequency range of \\( \\SI{1.0}{\\giga\\hertz} \\) to \\( \\SI{3.0}{\\giga\\hertz} \\).

![Initial S-parameters](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/before_optim.png)The initial results revealed several shortcomings:

- **Gain (S21)**: The gain was \\( \\SI{13.087}{\\deci\\bel} \\) at \\( \\SI{1.4}{\\giga\\hertz} \\) but dropped to \\( \\SI{11.646}{\\deci\\bel} \\) at \\( \\SI{1.84}{\\giga\\hertz} \\). Within the target range of \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), the gain decreases linearly from \\( \\SI{13.087}{\\deci\\bel} \\) to approximately \\( \\SI{11.8}{\\deci\\bel} \\) (estimated at \\( \\SI{1.8}{\\giga\\hertz} \\)), falling below the \\( \\SI{12}{\\deci\\bel} \\) target near the upper end of the band.
- **Input Return Loss (S11)**: S11 was \\( \\SI{-13.087}{\\deci\\bel} \\) at \\( \\SI{1.4}{\\giga\\hertz} \\) and \\( \\SI{-11.646}{\\deci\\bel} \\) at \\( \\SI{1.84}{\\giga\\hertz} \\), remaining \\( \\leq \\SI{-10}{\\deci\\bel} \\) across the band. This meets the specification, but the input matching could be further optimized to reduce the noise figure.
- **Output Return Loss (S22)**: S22 was poor at \\( \\SI{1.4}{\\giga\\hertz} \\) (\\( \\SI{-5}{\\deci\\bel} \\)), failing the \\( \\leq \\SI{-10}{\\deci\\bel} \\) goal. It improved to \\( \\SI{-16}{\\deci\\bel} \\) at \\( \\SI{1.84}{\\giga\\hertz} \\), but within \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), S22 ranges from \\( \\SI{-5}{\\deci\\bel} \\) to around \\( \\SI{-14}{\\deci\\bel} \\) (estimated at \\( \\SI{1.8}{\\giga\\hertz} \\)), failing the goal at the lower end of the band.
- **Stability (SP_STBFACT)**: The stability factor ranged from 0.75 to 1.15 across \\( \\SI{1.0}{\\giga\\hertz} \\) to \\( \\SI{3.0}{\\giga\\hertz} \\). Within \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), it was approximately 0.85 to 0.95, indicating potential instability (\\( K &lt; 1 \\)).
- **Noise Figure**: Not shown in this plot, but later results indicate the initial noise figure was around \\( \\SI{5}{\\deci\\bel} \\), well above the \\( \\SI{2}{\\deci\\bel} \\) target. This is likely due to the input matching not being optimized for the minimum noise figure (\\( \\Gamma_s \\neq \\Gamma\_{\\text{opt}} \\)).

---

## Optimization in ADS

The optimization framework was set up in ADS using the Optimization Cockpit, as shown below. Seven goals were defined to target the following performance metrics:

- **Gain Flatness Across the Band**: S21 \\( \\geq \\SI{12}{\\deci\\bel} \\) from \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\) (OptimGoal4 and OptimGoal6).
- **Input/Output Matching**: S11 \\( \\leq \\SI{-10}{\\deci\\bel} \\) (OptimGoal1) and S22 \\( \\leq \\SI{-10}{\\deci\\bel} \\) (OptimGoal2 and OptimGoal7).
- **Noise Figure Minimization**: Noise figure \\( \\leq \\SI{2}{\\deci\\bel} \\) (OptimGoal3).
- **Stability Assurance**: SP_STBFACT \\( \\geq 1 \\) (OptimGoal5).

![Optimization setup with design goals](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/whole_setup_for_optimization.png)\### Optimization Process

The optimization process was conducted in multiple iterations, with the final state after 77 iterations shown below. The optimization achieved an error of 0.156429, indicating that not all goals were fully met.

![Optimization progress and parameters](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/optimization_cockpit.png)The optimization variables included the lengths (TL1_L to TL6_L) and widths (w11 to w23) of the microstrip lines. The key optimized parameters are listed below:

| Parameter | Value |
| --- | --- |
| TL1_L | \\( \\SI{12.2639}{\\milli\\meter} \\) |
| TL2_L | \\( \\SI{19.3972}{\\milli\\meter} \\) |
| TL3_L | \\( \\SI{39.9198}{\\milli\\meter} \\) |
| TL4_L | \\( \\SI{21.4411}{\\milli\\meter} \\) |
| TL5_L | \\( \\SI{39.9996}{\\milli\\meter} \\) |
| TL6_L | \\( \\SI{35.01}{\\milli\\meter} \\) |
| w11 | \\( \\SI{2.8233}{\\milli\\meter} \\) |
| w12 | \\( \\SI{2.9659}{\\milli\\meter} \\) |
| w13 | \\( \\SI{0.21191}{\\milli\\meter} \\) |
| w21 | \\( \\SI{0.79796}{\\milli\\meter} \\) |
| w22 | \\( \\SI{3.47089}{\\milli\\meter} \\) |
| w23 | \\( \\SI{3.99437}{\\milli\\meter} \\) |

The optimization process proceeded in two main iterations:

1. **First Iteration**: Focused on improving gain, S22, and noise figure. The results showed:
   - **Gain**: \\( \\SI{14.275}{\\deci\\bel} \\) to \\( \\SI{12.542}{\\deci\\bel} \\), meeting the goal.
   - **S11**: \\( \\SI{-10.099}{\\deci\\bel} \\) to \\( \\SI{-10.376}{\\deci\\bel} \\), meeting the goal.
   - **S22**: \\( \\SI{-12.518}{\\deci\\bel} \\) to \\( \\SI{-10.318}{\\deci\\bel} \\), meeting the goal.
   - **Noise Figure**: Reduced to \\( \\SI{2.6}{\\deci\\bel} \\), still above the target.
   - **Stability**: SP_STBFACT remained below 1 (0.85 to 0.95).
2. **Second Iteration**: Further optimized the noise figure and stability. The error history plot in the cockpit shows a decreasing trend, with the largest contributions to the error coming from the noise figure (OptimGoal3) and stability (OptimGoal5) goals.

The optimization involved trade-offs, such as:

- Improving the noise figure by adjusting the input matching network (TL4, TL5) to move \\( \\Gamma_s \\) closer to \\( \\Gamma\_{\\text{opt}} \\), which slightly degraded S11 (from \\( \\SI{-13.087}{\\deci\\bel} \\) to \\( \\SI{-10.245}{\\deci\\bel} \\) at \\( \\SI{1.4}{\\giga\\hertz} \\)).
- Enhancing stability by tuning the output matching network (TL2, TL3), which slightly reduced the gain margin at \\( \\SI{1.8}{\\giga\\hertz} \\) (from \\( \\SI{12.542}{\\deci\\bel} \\) to \\( \\SI{12.562}{\\deci\\bel} \\)).

---

## Stability Analysis

The stability of the LNA was analyzed using the Rollett stability factor \\( K \\), defined as:

$$ K = \\frac{1 - |S\_{11}|^2 - |S\_{22}|^2 + |\\Delta|^2}{2|S\_{12}S\_{21}|} $$

where:

- \\( \\Delta = S\_{11}S\_{22} - S\_{12}S\_{21} \\)

For unconditional stability, \\( K &gt; 1 \\) and \\( |\\Delta| &lt; 1 \\) must hold across the frequency band. In ADS, the stability factor is approximated by SP_STBFACT.

The final stability factor is shown below:

![Stability factor verification](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/stability_factor.png)The results show:

- At \\( \\SI{1.6}{\\giga\\hertz} \\), SP_STBFACT = 1.003, indicating unconditional stability.
- Across \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), SP_STBFACT ranges from approximately 0.95 to 1.05, slightly below 1 at the edges of the band, meaning the amplifier is not fully unconditionally stable but is very close.

---

## Input Matching

The input return loss (S11) performance is shown below:

![Input matching network S-parameters](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/input_matching_results.png)The results show:

- At \\( \\SI{1.4}{\\giga\\hertz} \\): S11 = \\( \\SI{-10.245}{\\deci\\bel} \\) (marker m3).
- At \\( \\SI{1.78}{\\giga\\hertz} \\): S11 = \\( \\SI{-11.253}{\\deci\\bel} \\) (marker m4).
- Across \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), S11 remains \\( \\leq \\SI{-10}{\\deci\\bel} \\), meeting the specification.

The input matching network (TL4, TL5) was optimized to achieve this performance, with a trade-off to reduce the noise figure by moving \\( \\Gamma_s \\) closer to \\( \\Gamma\_{\\text{opt}} \\).

---

## Output Matching

The output return loss (S22) performance is shown below:

![Output matching network S-parameters](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/output_matching_network_s_par.png)The results show:

- At \\( \\SI{1.4}{\\giga\\hertz} \\): S22 = \\( \\SI{-12.255}{\\deci\\bel} \\) (marker m7).
- At \\( \\SI{1.8}{\\giga\\hertz} \\): S22 = \\( \\SI{-11.801}{\\deci\\bel} \\) (marker m6).
- Across \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), S22 remains \\( \\leq \\SI{-10}{\\deci\\bel} \\), exceeding the specification.

The output matching network (TL2, TL3) was significantly improved during optimization, correcting the initial poor S22 of \\( \\SI{-5}{\\deci\\bel} \\) at \\( \\SI{1.4}{\\giga\\hertz} \\).

---

## Gain Performance

The optimized gain performance is shown below:

![Final S-parameters after optimization](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/after_optim.png)The results show:

- At \\( \\SI{1.4}{\\giga\\hertz} \\): S21 = \\( \\SI{14.262}{\\deci\\bel} \\) (marker m1).
- At \\( \\SI{1.8}{\\giga\\hertz} \\): S21 = \\( \\SI{12.562}{\\deci\\bel} \\) (marker m2).
- Across \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), S21 ranges from \\( \\SI{14.262}{\\deci\\bel} \\) to \\( \\SI{12.562}{\\deci\\bel} \\), consistently \\( \\geq \\SI{12}{\\deci\\bel} \\), meeting the specification.

The gain flatness is \\( \\SI{1.7}{\\deci\\bel} \\), with an average gain of approximately \\( \\SI{13.4}{\\deci\\bel} \\).

---

## Noise Performance

The noise figure performance is shown below:

![Noise figure performance](https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/noise_figure.png)The results show:

- At \\( \\SI{1.6}{\\giga\\hertz} \\): Noise figure = \\( \\SI{2.091}{\\deci\\bel} \\) (marker m5).
- At \\( \\SI{1.8}{\\giga\\hertz} \\): Noise figure = \\( \\SI{1.996}{\\deci\\bel} \\) (marker m8).
- Across \\( \\SI{1.4}{\\giga\\hertz} \\) to \\( \\SI{1.8}{\\giga\\hertz} \\), the noise figure ranges from approximately \\( \\SI{2.1}{\\deci\\bel} \\) to \\( \\SI{1.996}{\\deci\\bel} \\).

The noise figure goal is \\( \\leq \\SI{2}{\\deci\\bel} \\). The final design achieves \\( \\SI{1.996}{\\deci\\bel} \\) at \\( \\SI{1.8}{\\giga\\hertz} \\), but is slightly above \\( \\SI{2}{\\deci\\bel} \\) at \\( \\SI{1.6}{\\giga\\hertz} \\) (\\( \\SI{2.091}{\\deci\\bel} \\)) and likely at \\( \\SI{1.4}{\\giga\\hertz} \\) (around \\( \\SI{2.1}{\\deci\\bel} \\)).

---

## Conclusion

The designed LNA meets most of the specifications, with some areas for improvement. The key achievements are summarized as follows:

- **Average Gain**: \\( \\SI{14.262}{\\deci\\bel} \\) to \\( \\SI{12.562}{\\deci\\bel} \\), with an average of \\( \\SI{13.4}{\\deci\\bel} \\) and a flatness of \\( \\SI{1.7}{\\deci\\bel} \\), exceeding the \\( \\SI{12}{\\deci\\bel} \\) requirement.
- **Input/Output Return Loss**: S11 ranges from \\( \\SI{-10.245}{\\deci\\bel} \\) to \\( \\SI{-11.253}{\\deci\\bel} \\), and S22 ranges from \\( \\SI{-12.255}{\\deci\\bel} \\) to \\( \\SI{-11.801}{\\deci\\bel} \\), both meeting the \\( \\leq \\SI{-10}{\\deci\\bel} \\) goal.
- **Noise Figure**: Ranges from \\( \\SI{2.091}{\\deci\\bel} \\) to \\( \\SI{1.996}{\\deci\\bel} \\), meeting the goal at \\( \\SI{1.8}{\\giga\\hertz} \\) but slightly above at \\( \\SI{1.6}{\\giga\\hertz} \\).

**Stability**: SP_STBFACT = 1.003 at \\( \\SI{1.6}{\\giga\\hertz} \\), but slightly below 1 at the band edges (0.95 to 1.05), indicating near-unconditional stability.
