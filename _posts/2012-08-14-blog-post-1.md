
title: "Low Noise Amplifier (LNA) Design Using ADS"date: 2025-09-06permalink: /posts/2025/09/lna-design/tags:  - RFIC  - Microwave Engineering  - ADS  - Low Noise Amplifier
Introduction
This post documents the complete design process of a Low Noise Amplifier (LNA) operating from ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), designed using Advanced Design System (ADS). The design specifications are as follows:

Frequency range: ( \SI{1.4}{\giga\hertz} )–( \SI{1.8}{\giga\hertz} )
Gain: ( \geq \SI{12}{\deci\bel} )
Input/output return loss: ( \geq \SI{10}{\deci\bel} ) (i.e., ( S_{11} ) and ( S_{22} \leq \SI{-10}{\deci\bel} ))
Noise figure: ( \leq \SI{2}{\deci\bel} )
Stability factor: ( K > 1 ) across the band (unconditional stability)

The design process involved schematic creation, component selection, initial simulation, optimization, and final performance evaluation. The LNA was designed using microstrip technology with a single-stage topology, focusing on achieving a balance between low noise figure, high gain, and stability. This post details each step, including challenges faced (e.g., initial poor output matching and high noise figure) and the optimization strategies employed to meet the specifications.
Schematic Design
The LNA was designed as a single-stage amplifier using microstrip lines for matching and biasing networks. The complete schematic, shown in Figure 1, features the following components:

Input Matching Network: Composed of microstrip lines (TL4, TL5) and a DC block capacitor (C1) to ensure proper impedance matching at the input while blocking DC signals. The matching network was designed to minimize the noise figure by aligning the input impedance close to the optimum noise match (( \Gamma_{\text{opt}} )).
Bias Network: Includes a microstrip line (TL6) and an RF choke (MLEF) to provide the DC bias to the transistor while isolating the RF signal path. The bias network ensures the transistor operates at the desired operating point for low noise and high gain.
Output Matching Network: Composed of microstrip lines (TL2, TL3) and a DC block capacitor (C2) to match the output impedance to ( \SI{50}{\ohm} ), ensuring maximum power transfer and good return loss.
Stabilization Components: The design initially lacked explicit stabilization components (e.g., series resistors), but stability was addressed through optimization of the matching networks to achieve a stability factor ( K > 1 ).

The schematic uses the ATF-54111 transistor, a GaAs pHEMT, selected for its low noise figure and high gain characteristics. The input and output ports are terminated with ( \SI{50}{\ohm} ) loads (Term1 and Term2), and the substrate is defined as "MSub1" with a thickness of ( \SI{0.5}{\milli\meter} ).

Figure 1: LNA schematic.
Component Selection
The transistor chosen for the LNA is the hp-AT-41511-2-19950125, a GaAs pHEMT, selected for the following reasons:

Low Noise Figure: The ATF-54111 has a minimum noise figure (( F_{\text{min}} )) of approximately ( \SI{0.5}{\deci\bel} ) to ( \SI{1.0}{\deci\bel} ) at ( \SI{1.6}{\giga\hertz} ), making it suitable for low-noise applications. The noise figure of the LNA is given by the Friis formula for a single-stage amplifier:

[F = F_{\text{min}} + \frac{R_n}{G_s} |\Gamma_s - \Gamma_{\text{opt}}|^2]
where ( F_{\text{min}} ) is the minimum noise figure, ( R_n ) is the equivalent noise resistance, ( G_s ) is the source conductance, ( \Gamma_s ) is the source reflection coefficient, and ( \Gamma_{\text{opt}} ) is the optimum source reflection coefficient for minimum noise. The low ( F_{\text{min}} ) of the ATF-54111 ensures a good starting point for achieving the ( \SI{2}{\deci\bel} ) noise figure goal.

Adequate Gain: The transistor provides a maximum available gain (( G_{\text{max}} )) greater than ( \SI{15}{\deci\bel} ) at ( \SI{1.6}{\giga\hertz} ), which supports the design goal of ( \geq \SI{12}{\deci\bel} ). The gain of a single-stage amplifier can be approximated as:

[G = |S_{21}|^2 \frac{(1 - |\Gamma_s|^2)(1 - |\Gamma_L|^2)}{|1 - S_{11}\Gamma_s|^2 |1 - S_{22}\Gamma_L|^2}]
where ( \Gamma_s ) and ( \Gamma_L ) are the source and load reflection coefficients, respectively. The high ( G_{\text{max}} ) ensures the gain requirement can be met with proper matching.

Good Input/Output Match Capability: The ATF-54111 has S-parameters that allow for effective impedance matching using microstrip lines, as evidenced by the final S11 and S22 values achieved after optimization.

Other components, such as the DC block capacitors (C1, C2) and microstrip lines, were chosen to operate effectively at the target frequency range, with values optimized during the design process.
Substrate Parameters
The microstrip design uses a substrate with the following parameters, which are typical for FR-4 but adjusted based on the schematic’s "MSub1" definition:

( \epsilon_r = 4.3 ) (relative permittivity)
( h = \SI{0.5}{\milli\meter} ) (substrate thickness, from schematic)
( \tan\delta = 0.02 ) (loss tangent)
( t = \SI{35}{\micro\meter} ) (copper thickness)

The characteristic impedance (( Z_0 )) of the microstrip lines was calculated using the approximate formula for a microstrip line:
[Z_0 = \frac{87}{\sqrt{\epsilon_r + 1.41}} \ln\left(\frac{5.98h}{0.8w + t}\right)]
where ( w ) is the width of the microstrip line. During optimization, the widths (w11 to w23) were tuned to achieve the desired impedance matching. For example, with ( h = \SI{0.5}{\milli\meter} ), ( \epsilon_r = 4.3 ), and ( t = \SI{35}{\micro\meter} ), a width ( w \approx \SI{1}{\milli\meter} ) (typical for the optimized values like w11 = ( \SI{2.8233}{\milli\meter} )) yields a ( Z_0 ) close to ( \SI{50}{\ohm} ), which is ideal for matching to the ( \SI{50}{\ohm} ) terminations. The loss tangent (( \tan\delta = 0.02 )) indicates moderate substrate losses, which contribute to the overall noise figure and gain flatness.
Initial Simulation Results
The initial performance of the LNA, before any optimization, is shown in Figure 2. The plots include S21 (gain), S11 (input return loss), S22 (output return loss), and SP_STBFACT (stability factor) over a frequency range of ( \SI{1.0}{\giga\hertz} ) to ( \SI{3.0}{\giga\hertz} ).

Figure 2: Initial performance before optimization: (a) S21 (gain), (b) S11 (input return loss), (c) S22 (output return loss), (d) SP_STBFACT (stability factor).
The initial results revealed several shortcomings:

Gain (S21): The gain was ( \SI{13.087}{\deci\bel} ) at ( \SI{1.4}{\giga\hertz} ) but dropped to ( \SI{11.646}{\deci\bel} ) at ( \SI{1.84}{\giga\hertz} ). Within the target range of ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), the gain decreases linearly from ( \SI{13.087}{\deci\bel} ) to approximately ( \SI{11.8}{\deci\bel} ) (estimated at ( \SI{1.8}{\giga\hertz} )), falling below the ( \SI{12}{\deci\bel} ) target near the upper end of the band. This indicates the need for better gain flatness through output matching optimization.
Input Return Loss (S11): S11 was ( \SI{-13.087}{\deci\bel} ) at ( \SI{1.4}{\giga\hertz} ) and ( \SI{-11.646}{\deci\bel} ) at ( \SI{1.84}{\giga\hertz} ), remaining ( \leq \SI{-10}{\deci\bel} ) across the band. This meets the specification, but the input matching could be further optimized to reduce the noise figure.
Output Return Loss (S22): S22 was poor at ( \SI{1.4}{\giga\hertz} ) (( \SI{-5}{\deci\bel} )), failing the ( \leq \SI{-10}{\deci\bel} ) goal. It improved to ( \SI{-16}{\deci\bel} ) at ( \SI{1.84}{\giga\hertz} ), but within ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), S22 ranges from ( \SI{-5}{\deci\bel} ) to around ( \SI{-14}{\deci\bel} ) (estimated at ( \SI{1.8}{\giga\hertz} )), failing the goal at the lower end of the band. This highlights the need for output matching network optimization.
Stability (SP_STBFACT): The stability factor ranged from 0.75 to 1.15 across ( \SI{1.0}{\giga\hertz} ) to ( \SI{3.0}{\giga\hertz} ). Within ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), it was approximately 0.85 to 0.95, indicating potential instability (( K < 1 )). This necessitates adjustments to the matching networks to ensure unconditional stability.
Noise Figure: Not shown in this plot, but later results indicate the initial noise figure was around ( \SI{5}{\deci\bel} ), well above the ( \SI{2}{\deci\bel} ) target. This is likely due to the input matching not being optimized for the minimum noise figure (( \Gamma_s \neq \Gamma_{\text{opt}} )).

These initial results demonstrated the need for optimization, particularly in the output matching network (to improve S22 and gain flatness), input matching (to reduce the noise figure), and overall design (to ensure stability).
Optimization Setup
The optimization framework was set up in ADS using the Optimization Cockpit, as shown in Figure 3. Seven goals were defined to target the following performance metrics:

Gain Flatness Across the Band: S21 ( \geq \SI{12}{\deci\bel} ) from ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ) (OptimGoal4 and OptimGoal6), ensuring the gain remains above the target with minimal variation.
Input/Output Matching: S11 ( \leq \SI{-10}{\deci\bel} ) (OptimGoal1) and S22 ( \leq \SI{-10}{\deci\bel} ) (OptimGoal2 and OptimGoal7), ensuring good impedance matching at both ports.
Noise Figure Minimization: Noise figure ( \leq \SI{2}{\deci\bel} ) (OptimGoal3), aiming to reduce the noise figure by optimizing the input matching network.
Stability Assurance: SP_STBFACT ( \geq 1 ) (OptimGoal5), ensuring unconditional stability across the band.


Figure 3: Optimization setup with design goals.
The optimization variables included the lengths (TL1_L to TL6_L) and widths (w11 to w23) of the microstrip lines, allowing the matching networks to be tuned for optimal performance. A gradient-based optimization algorithm was used, as indicated by the "Gradient" status in the cockpit.
Optimization Process
The optimization process was conducted in multiple iterations, with the final state after 77 iterations shown in Figure 4. The optimization achieved an error of 0.156429, indicating that not all goals were fully met (a zero error would indicate perfect achievement of all goals).

Figure 4: Optimization progress and parameters after 77 iterations.
The key optimized parameters for the microstrip lines are listed in Table 1. These values were tuned to balance the trade-offs between gain, return loss, noise figure, and stability.



Parameter
Value



TL1_L
( \SI{12.2639}{\milli\meter} )


TL2_L
( \SI{19.3972}{\milli\meter} )


TL3_L
( \SI{39.9198}{\milli\meter} )


TL4_L
( \SI{21.4411}{\milli\meter} )


TL5_L
( \SI{39.9996}{\milli\meter} )


TL6_L
( \SI{35.01}{\milli\meter} )


w11
( \SI{2.8233}{\milli\meter} )


w12
( \SI{2.9659}{\milli\meter} )


w13
( \SI{0.21191}{\milli\meter} )


w21
( \SI{0.79796}{\milli\meter} )


w22
( \SI{3.47089}{\milli\meter} )


w23
( \SI{3.99437}{\milli\meter} )


Table 1: Optimized Transmission Line Parameters
The optimization process proceeded in two main iterations:

First Iteration: Focused on improving gain, S22, and noise figure. The results after this iteration showed:
Gain: ( \SI{14.275}{\deci\bel} ) to ( \SI{12.542}{\deci\bel} ), meeting the goal.
S11: ( \SI{-10.099}{\deci\bel} ) to ( \SI{-10.376}{\deci\bel} ), meeting the goal.
S22: ( \SI{-12.518}{\deci\bel} ) to ( \SI{-10.318}{\deci\bel} ), meeting the goal.
Noise Figure: Reduced to ( \SI{2.6}{\deci\bel} ), still above the target.
Stability: SP_STBFACT remained below 1 (0.85 to 0.95).


Second Iteration: Further optimized the noise figure and stability, leading to the final results shown in the subsequent sections. The error history plot in the cockpit shows a decreasing trend, with the largest contributions to the error coming from the noise figure (OptimGoal3) and stability (OptimGoal5) goals, indicating these were the hardest to meet.

The optimization involved trade-offs, such as:

Improving the noise figure by adjusting the input matching network (TL4, TL5) to move ( \Gamma_s ) closer to ( \Gamma_{\text{opt}} ), which slightly degraded S11 (from ( \SI{-13.087}{\deci\bel} ) to ( \SI{-10.245}{\deci\bel} ) at ( \SI{1.4}{\giga\hertz} )).
Enhancing stability by tuning the output matching network (TL2, TL3), which slightly reduced the gain margin at ( \SI{1.8}{\giga\hertz} ) (from ( \SI{12.542}{\deci\bel} ) to ( \SI{12.562}{\deci\bel} )).

Stability Analysis
The stability of the LNA was analyzed using the Rollett stability factor ( K ), defined as:
[K = \frac{1 - |S_{11}|^2 - |S_{22}|^2 + |\Delta|^2}{2|S_{12}S_{21}|}]
where ( \Delta = S_{11}S_{22} - S_{12}S_{21} ). For unconditional stability, ( K > 1 ) and ( |\Delta| < 1 ) must hold across the frequency band. In ADS, the stability factor is approximated by SP_STBFACT, which is equivalent to ( K ) for most practical purposes.
The final stability factor is shown in Figure 5, which corresponds to the SP_STBFACT plot from the final simulation results.

Figure 5: Stability factor verification (SP_STBFACT).
The results show:

At ( \SI{1.6}{\giga\hertz} ), SP_STBFACT = 1.003, indicating unconditional stability at this frequency.
Across ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), SP_STBFACT ranges from approximately 0.95 to 1.05 (visually estimated). It is slightly below 1 at the edges of the band, meaning the amplifier is not unconditionally stable across the entire range but is very close.

The initial design had SP_STBFACT ranging from 0.85 to 0.95, indicating potential instability. The optimization process improved this by adjusting the matching networks to reduce the magnitudes of ( S_{11} ) and ( S_{22} ), thereby increasing ( K ). The final value of 1.003 at ( \SI{1.6}{\giga\hertz} ) suggests the design is stable at the center frequency, but further optimization (e.g., adding a series resistor or adjusting the matching networks) could ensure ( K > 1 ) across the entire band.
Input Matching
The input return loss (S11) performance is shown in Figure 6, which corresponds to the S11 plot from the final simulation results.

Figure 6: Input matching network S-parameters.
The results show:

At ( \SI{1.4}{\giga\hertz} ): S11 = ( \SI{-10.245}{\deci\bel} ) (marker m3).
At ( \SI{1.78}{\giga\hertz} ): S11 = ( \SI{-11.253}{\deci\bel} ) (marker m4).
Across ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), S11 remains ( \leq \SI{-10}{\deci\bel} ), meeting the specification.

The input matching network (TL4, TL5) was optimized to achieve this performance. However, a trade-off was made to reduce the noise figure: the input impedance was adjusted to move ( \Gamma_s ) closer to ( \Gamma_{\text{opt}} ) for minimum noise figure, which slightly degraded S11 (from ( \SI{-13.087}{\deci\bel} ) to ( \SI{-10.245}{\deci\bel} ) at ( \SI{1.4}{\giga\hertz} )). This trade-off is acceptable since S11 still meets the goal, and the noise figure was reduced from ( \SI{5}{\deci\bel} ) to ( \SI{1.996}{\deci\bel} ) at ( \SI{1.8}{\giga\hertz} ).
Output Matching
The output return loss (S22) performance is shown in Figure 7, which corresponds to the S22 plot from the final simulation results.

Figure 7: Output matching network S-parameters.
The results show:

At ( \SI{1.4}{\giga\hertz} ): S22 = ( \SI{-12.255}{\deci\bel} ) (marker m7).
At ( \SI{1.8}{\giga\hertz} ): S22 = ( \SI{-11.801}{\deci\bel} ) (marker m6).
Across ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), S22 remains ( \leq \SI{-10}{\deci\bel} ), exceeding the specification with a margin of at least ( \SI{1.8}{\deci\bel} ).

The output matching network (TL2, TL3) was significantly improved during optimization. The initial design had a poor S22 of ( \SI{-5}{\deci\bel} ) at ( \SI{1.4}{\giga\hertz} ), which was corrected to ( \SI{-12.518}{\deci\bel} ) after the first optimization and further refined to ( \SI{-12.255}{\deci\bel} ) in the final design. This improvement ensures maximum power transfer to the ( \SI{50}{\ohm} ) load and contributes to the overall gain flatness.
Gain Performance
The optimized gain performance is shown in Figure 8, which corresponds to the S21 plot from the final simulation results.

Figure 8: Final Results after optimization.
The results show:

At ( \SI{1.4}{\giga\hertz} ): S21 = ( \SI{14.262}{\deci\bel} ) (marker m1).
At ( \SI{1.8}{\giga\hertz} ): S21 = ( \SI{12.562}{\deci\bel} ) (marker m2).
Across ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), S21 ranges from ( \SI{14.262}{\deci\bel} ) to ( \SI{12.562}{\deci\bel} ), consistently ( \geq \SI{12}{\deci\bel} ), meeting the specification.

The gain flatness is ( \SI{14.262}{\deci\bel} - \SI{12.562}{\deci\bel} = \SI{1.7}{\deci\bel} ), which is reasonable for an LNA in this frequency range. The initial design had a gain that dropped below ( \SI{12}{\deci\bel} ) near ( \SI{1.8}{\giga\hertz} ) (( \SI{11.8}{\deci\bel} ) estimated), but the optimization process improved the output matching and bias network, resulting in a gain that exceeds the target across the band. The average gain is approximately ( \SI{13.4}{\deci\bel} ) ((( \SI{14.262}{\deci\bel} + \SI{12.562}{\deci\bel} )/2)), providing a good margin above the ( \SI{12}{\deci\bel} ) requirement.
Noise Performance
The noise figure performance is shown in Figure 9, which corresponds to the NF2 plot from the final simulation results.

Figure 9: Noise figure performance (NF2).
The results show:

At ( \SI{1.6}{\giga\hertz} ): Noise figure = ( \SI{2.091}{\deci\bel} ) (marker m5).
At ( \SI{1.8}{\giga\hertz} ): Noise figure = ( \SI{1.996}{\deci\bel} ) (marker m8).
Across ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ), the noise figure ranges from approximately ( \SI{2.1}{\deci\bel} ) to ( \SI{1.996}{\deci\bel} ) (visually estimated at ( \SI{1.4}{\giga\hertz} )).

The noise figure goal is ( \leq \SI{2}{\deci\bel} ) across the band. The final design achieves ( \SI{1.996}{\deci\bel} ) at ( \SI{1.8}{\giga\hertz} ), which meets the goal at that frequency, but it is slightly above ( \SI{2}{\deci\bel} ) at ( \SI{1.6}{\giga\hertz} ) (( \SI{2.091}{\deci\bel} )) and likely at ( \SI{1.4}{\giga\hertz} ) (around ( \SI{2.1}{\deci\bel} )). Therefore, the noise figure does not fully meet the specification across the entire band. The initial noise figure was around ( \SI{5}{\deci\bel} ), which was reduced to ( \SI{2.6}{\deci\bel} ) after the first optimization and further to ( \SI{1.996}{\deci\bel} ) to ( \SI{2.091}{\deci\bel} ) in the final design. This improvement was achieved by optimizing the input matching network to move ( \Gamma_s ) closer to ( \Gamma_{\text{opt}} ), but the transistor’s ( F_{\text{min}} ) and substrate losses (( \tan\delta = 0.02 )) limit further reduction without changing the design (e.g., using a lower-noise transistor or a better substrate).
Conclusion
The designed LNA meets most of the specifications, with some areas for improvement. The key achievements are summarized as follows:

Average Gain: The gain ranges from ( \SI{14.262}{\deci\bel} ) to ( \SI{12.562}{\deci\bel} ), with an average of ( \SI{13.4}{\deci\bel} ) and a flatness of ( \SI{1.7}{\deci\bel} ), exceeding the ( \SI{12}{\deci\bel} ) requirement.
Input/Output Return Loss: S11 ranges from ( \SI{-10.245}{\deci\bel} ) to ( \SI{-11.253}{\deci\bel} ), and S22 ranges from ( \SI{-12.255}{\deci\bel} ) to ( \SI{-11.801}{\deci\bel} ), both meeting the ( \leq \SI{-10}{\deci\bel} ) goal with margin.
Noise Figure: The noise figure ranges from ( \SI{2.091}{\deci\bel} ) to ( \SI{1.996}{\deci\bel} ), which is almost ( \leq \SI{2}{\deci\bel} ) throughout the bandwidth. It meets the goal at ( \SI{1.8}{\giga\hertz} ) (( \SI{1.996}{\deci\bel} )) and is only slightly above the ( \SI{2}{\deci\bel} ) target at ( \SI{1.6}{\giga\hertz} ) (( \SI{2.091}{\deci\bel} )), demonstrating a close approximation to the specification across the ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} ) band.
Stability: The stability factor (SP_STBFACT) is 1.003 at ( \SI{1.6}{\giga\hertz} ), indicating unconditional stability at this frequency, but it is slightly below 1 at the edges of the band (0.95 to 1.05 across ( \SI{1.4}{\giga\hertz} ) to ( \SI{1.8}{\giga\hertz} )), meaning the design is not fully unconditionally stable.
