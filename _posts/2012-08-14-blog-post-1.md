---
title: "Low Noise Amplifier (LNA) Design Using ADS"
date: 2025-09-06
permalink: /posts/2025/09/lna-design/
tags:
  - RFIC
  - Microwave Engineering
  - ADS
  - Low Noise Amplifier
---

## Design Objective

The goal is to design a **Low Noise Amplifier (LNA)** with the following specifications:

- **Frequency range**: \\( \SI{1.4}{\text{GHz}} \\)–\\( \SI{1.8}{\text{GHz}} \\)
- **Gain**: \( \geq \SI{12}{\text{dB}} \)
- **Input/output return loss**: \\( \geq \SI{10}{\text{dB}} \\) (i.e., \\( S_{11} \\) and \\( S_{22} \leq \SI{-10}{\text{dB}} \\))
- **Noise figure**: \\( \leq \SI{2}{\text{dB}} \\)
- **Stability factor**: \\( K > 1 \\) across the band (unconditional stability)

The substrate used is defined as "MSub1":
- Relative permittivity \\( \epsilon_r = 4.3 \\)
- Thickness = \\( \SI{0.5}{\text{mm}} \\)
- Loss tangent \\( \tan\delta = 0.02 \\)
- Copper thickness = \\( \SI{35}{\text{um}} \\)

---

## Amplifier Design and Theory

The LNA is based on a **single-stage microstrip design**. The characteristic impedance of the microstrip line can be approximated by:

$$
Z_0 = \frac{87}{\sqrt{\epsilon_r + 1.41}} \ln\left(\frac{5.98h}{0.8w + t}\right)
$$

where:
- \\( h \\) = substrate height
- \\( w \\) = microstrip width
- \\( t \\) = copper thickness
- \\( \epsilon_r \\) = relative permittivity

The noise figure of the LNA is given by the Friis formula for a single-stage amplifier:

$$
F = F_{\text{min}} + \frac{R_n}{G_s} |\Gamma_s - \Gamma_{\text{opt}}|^2
$$

where:
- \\( F_{\text{min}} \\) = minimum noise figure
- \\( R_n \\) = equivalent noise resistance
- \\( G_s \\) = source conductance
- \\( \Gamma_s \\) = source reflection coefficient
- \\( \Gamma_{\text{opt}} \\) = optimum source reflection coefficient for minimum noise

The gain of the amplifier is approximated as:

$$
G = |S_{21}|^2 \frac{(1 - |\Gamma_s|^2)(1 - |\Gamma_L|^2)}{|1 - S_{11}\Gamma_s|^2 |1 - S_{22}\Gamma_L|^2}
$$

where:
- \\( \Gamma_s \\) = source reflection coefficient
- \\( \Gamma_L \\) = load reflection coefficient

---

## Schematic Design

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/lna_schem.png" alt="LNA schematic" width="700"/>

The LNA uses the ATF-54111 transistor, a GaAs pHEMT, with the following components:
- **Input Matching Network**: Microstrip lines (TL4, TL5) and DC block capacitor (C1) to ensure proper impedance matching at the input while blocking DC signals. The matching network minimizes the noise figure by aligning the input impedance close to \\( \Gamma_{\text{opt}} \\).
- **Bias Network**: Microstrip line (TL6) and RF choke (MLEF) to provide DC bias while isolating the RF signal path.
- **Output Matching Network**: Microstrip lines (TL2, TL3) and DC block capacitor (C2) to match the output impedance to \\( \SI{50}{\ohm} \\).
- **Stabilization**: Achieved through optimization of matching networks to ensure \\( K > 1 \\).

The input and output ports are terminated with \\( \SI{50}{\ohm} \\) loads (Term1 and Term2).

---

## Initial Simulation

The initial ADS simulation results show:
- Gain \\( S_{21} \approx \SI{13.087}{\text{dB}} \\) at \\( \SI{1.4}{\text{GHz}} \\), dropping to \\( \SI{11.646}{\text{dB}} \\) at \\( \SI{1.84}{\text{GHz}} \\).
- Input return loss \\( S_{11} \approx \SI{-13.087}{\text{dB}} \\) at \\( \SI{1.4}{\text{GHz}} \\), \\( \SI{-11.646}{\text{dB}} \\) at \\( \SI{1.84}{\text{GHz}} \\).
- Output return loss \\( S_{22} \approx \SI{-5}{\text{dB}} \\) at \\( \SI{1.4}{\text{GHz}} \\), \\( \SI{-16}{\text{dB}} \\) at \\( \SI{1.84}{\text{GHz}} \\).
- Stability factor (SP_STBFACT) \\( \approx 0.85–0.95 \\) in the band, indicating potential instability.
- Noise figure \\( \approx \SI{5}{\text{dB}} \\), above the target.

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/before_optim.png" alt="Initial S-parameters" width="700"/>

---

## Optimization in ADS

The **ADS Optimization Tool** was used with the following optimization variables:
- Line Lengths (\\( \text{TL1_L–TL6_L} \\)): Adjusted to optimize matching and stability.
- Line Widths (\\( \text{w11–w23} \\)): Tuned for impedance matching.

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/whole_setup_for_optimization.png" alt="Optimization setup with design goals" width="700"/>

### Optimization Process

The optimization was set up to:
- Minimize noise figure (\\( \leq \SI{2}{\text{dB}} \\)).
- Maximize gain (\\( S_{21} \geq \SI{12}{\text{dB}} \\)).
- Maximize return loss (\\( S_{11}, S_{22} \leq \SI{-10}{\text{dB}} \\)).
- Ensure stability (SP_STBFACT \\( \geq 1 \\)).

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/optimization_cockpit.png" alt="Optimization progress and parameters" width="700"/>

After 77 iterations, the final dimensions obtained are:

| Parameter | Value |
|-----------|-------|
| TL1_L     | \\( \SI{12.2639}{\text{mm}} \\) |
| TL2_L     | \\( \SI{19.3972}{\text{mm}} \\) |
| TL3_L     | \\( \SI{39.9198}{\text{mm}} \\) |
| TL4_L     | \\( \SI{21.4411}{\text{mm}} \\) |
| TL5_L     | \\( \SI{39.9996}{\text{mm}} \\) |
| TL6_L     | \\( \SI{35.01}{\text{mm}} \\) |
| w11       | \\( \SI{2.8233}{\text{mm}} \\) |
| w12       | \\( \SI{2.9659}{\text{mm}} \\) |
| w13       | \\( \SI{0.21191}{\text{mm}} \\) |
| w21       | \\( \SI{0.79796}{\text{mm}} \\) |
| w22       | \\( \SI{3.47089}{\text{mm}} \\) |
| w23       | \\( \SI{3.99437}{\text{mm}} \\) |

---

## Stability Analysis

The stability factor \\( K \\) is defined as:

$$
K = \frac{1 - |S_{11}|^2 - |S_{22}|^2 + |\Delta|^2}{2|S_{12}S_{21}|}
$$

where:
- \\( \Delta = S_{11}S_{22} - S_{12}S_{21} \\)

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/stability_factor.png" alt="Stability factor verification" width="700"/>

**Results:**
- At \\( \SI{1.6}{\text{GHz}} \\): SP_STBFACT = 1.003.
- Across \\( \SI{1.4}{\text{GHz}} \\)–\\( \SI{1.8}{\text{GHz}} \\): SP_STBFACT \\( \approx 0.95–1.05 \\), slightly below 1 at band edges.

---

## Input Matching

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/input_matching_results.png" alt="Input matching network S-parameters" width="700"/>

**Results:**
- At \\( \SI{1.4}{\text{GHz}} \\): \\( S_{11} = \SI{-10.245}{\text{dB}} \\) (marker m3).
- At \\( \SI{1.78}{\text{GHz}} \\): \\( S_{11} = \SI{-11.253}{\text{dB}} \\) (marker m4).
- Across \\( \SI{1.4}{\text{GHz}} \\)–\\( \SI{1.8}{\text{GHz}} \\): \\( S_{11} \leq \SI{-10}{\text{dB}} \\).

---

## Output Matching

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/output_matching_network_s_par.png" alt="Output matching network S-parameters" width="700"/>

**Results:**
- At \\( \SI{1.4}{\text{GHz}} \\): \\( S_{22} = \SI{-12.255}{\text{dB}} \\) (marker m7).
- At \\( \SI{1.8}{\text{GHz}} \\): \\( S_{22} = \SI{-11.801}{\text{dB}} \\) (marker m6).
- Across \\( \SI{1.4}{\text{GHz}} \\)–\\( \SI{1.8}{\text{GHz}} \\): \\( S_{22} \leq \SI{-10}{\text{dB}} \\).

---

## Gain Performance

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/after_optim.png" alt="Final S-parameters after optimization" width="700"/>

**Results:**
- At \\( \SI{1.4}{\text{GHz}} \\): \\( S_{21} = \SI{14.262}{\text{dB}} \\) (marker m1).
- At \\( \SI{1.8}{\text{GHz}} \\): \\( S_{21} = \SI{12.562}{\text{dB}} \\) (marker m2).
- Across \\( \SI{1.4}{\text{GHz}} \\)–\\( \SI{1.8}{\text{GHz}} \\): \\( S_{21} \geq \SI{12}{\text{dB}} \\).

---

## Noise Performance

<img src="https://abdelrahman-dip.github.io/abdelrahmanosman.github.io/images/LNA/noise_figure.png" alt="Noise figure performance" width="700"/>

**Results:**
- At \\( \SI{1.6}{\text{GHz}} \\): Noise figure = \\( \SI{2.091}{\text{dB}} \\) (marker m5).
- At \\( \SI{1.8}{\text{GHz}} \\): Noise figure = \\( \SI{1.996}{\text{dB}} \\) (marker m8).
- Across \\( \SI{1.4}{\text{GHz}} \\)–\\( \SI{1.8}{\text{GHz}} \\): Noise figure \\( \approx \SI{2.1}{\text{dB}} \\)–\\( \SI{1.996}{\text{dB}} \\).

---

## Final Results

- Frequency range: \\( \SI{1.4}{\text{GHz}} \\)–\\( \SI{1.8}{\text{GHz}} \\)
- \\( S_{21} \geq \SI{12}{\text{dB}} \)
- \\( S_{11}, S_{22} \leq \SI{-10}{\text{dB}} \\)
- Noise figure \\( \approx \SI{2}{\text{dB}} \\)
- Stability factor \\( K \approx 1 \\) at \\( \SI{1.6}{\text{GHz}} \\)

**Comparison Table:**

| Parameter | Specification | Simulation Result |
|-----------|---------------|-------------------|
| Frequency (GHz) | 1.4–1.8 | 1.4–1.8 |
| \\( S_{21} \\) at 1.4 GHz (dB) | ≥ 12 | 14.262 |
| \\( S_{21} \\) at 1.8 GHz (dB) | ≥ 12 | 12.562 |
| \\( S_{11} \\) in Band (dB) | ≤ -10 | -10.245 to -11.253 |
| \\( S_{22} \\) in Band (dB) | ≤ -10 | -12.255 to -11.801 |
| Noise Figure (dB) | ≤ 2 | 1.996–2.091 |
| Stability Factor (K) | > 1 | 0.95–1.05 |

---

## Conclusion

The final design meets most specifications, with minor deviations in noise figure and stability at band edges, demonstrating the effectiveness of the **ADS design flow with optimization** for LNA design.

---
